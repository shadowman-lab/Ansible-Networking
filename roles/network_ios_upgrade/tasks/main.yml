---
- name: Copy Image // This could take up to 4 minutes
  ansible.netcommon.net_put: 
    src: "~/network-programmability/images/{{ image }}"
    dest: "flash:/{{ image }}"
  vars: 
    ansible_command_timeout: 600

- name: Change Boot Variable to new image 
  cisco.ios.ios_config: 
    commands: 
      - "boot system flash:{{ image }}"
    save_when: always 

- name: Reload the Device 
  ansible.netcommon.cli_command:   
    command: reload
    prompt: 
      - confirm
    answer: 
      - 'y'

- name: Wait for device to come back online
  ansible.builtin.wait_for_connection:
    delay: 90
  